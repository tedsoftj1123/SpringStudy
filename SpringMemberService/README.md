# JWT

본론으로 들어가기 전에 인증과 인가가 그리고 세션방식이 무엇인지 알아보자

 인증(Authentication)은 유저가 누구인지 확인하는 절차 회원가입하고 로그인이라고 생각하면된다.

그리고 인가(Authorizatioin)는   로그인된 유저가 웹을 돌아다니면서 사용할 수 있는 기능들에 대한 권한을 허락해주는 것이다.

다음으로 세션 방식에 대해 설명하겠다. 클라이언트가 서버에 접속하게 되면 서버가 세션 ID를 발급해서 쿠키 즉 브라우저에 저장을 해놓는다. 그럼 이후에 서버에 요청을 보낼때 이 쿠키의 세션ㅇID를 함께 보내서 인가를 하는 것이다. 이런 세션방식에는 단점이 있는데 클라이언트가 요청을 보낼때마다 db에서 값을 봐야한다는 점과 재부팅을 하게 되면 값이 다 초기화가 된다는 것이다.

위의 단점을 보완하기 위해 토큰 방식이 생겼는데 그 중 가장 대표적인 방식 이 JWT(JSON Web Token)방식 인것이다.

세션과 다르게 토큰은 로그인을 하면 클라에게 토큰만 생성해서 넘겨주고 자서버는 별도의 정보를 저장하지 않는다. 그리고 다음요청시 클라이언트는 요청에 헤더에 토큰을 보내고 서버가 그 토큰을 인증하여 인가를 해주는 방식이다.

JWT는 토큰이라 뭔 영문자들이 어지럽게 석여있는데 잘 보면 총 3가지로 분류되는 것을 알 수 있다.

이는 각각 header, payload, verify signature로 구분된다.

### Payload

JWT의 PayLoad부분을 base64라는 방식으로 디코딩해보면 JSON형식의 여러 정보들이 담겨져있다. 이렇게 토큰에 담긴 사용자의 정보를 Claim이라고 한다.

### Header

헤더엔 두가지 정보가 담겨져있다. 첫째로 type인데 이건 JWT를 사용하기 때문에 고정으로 JWT가 들어있다. 그리고 alg이란게 있는데 이 곳에는 

다음으로 설명할 signature값을 만드는데 사용될 알고리즘이 지정된다. 

### Signature

그럼 사용자가 토큰을 수정해서 계정을 관리자권한으로 만드는 등의 악용이 생길 수 있다. 따라서 JWT는 payload와 header의 값을 서버가 가지고 있는 비밀키 와 돌려봐서 계산될 결과값이 signature, 서명값과 같는지 비교해본다.

앞에서 말했듯 서버는 값을 저장하지않고 요청일 올때마다 토큰을 확인해 사용자를 걸르는데 이처럼 시간에 따라 바뀌는 상태값을 가지지 않는 것을 stateless라고 한다. 반면에 모든 사용자들의 상태를 기억하는 세션 방식의 경우 statefull이라고 할 수 있다.